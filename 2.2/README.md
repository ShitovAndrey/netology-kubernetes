# Домашнее задание к занятию «Хранение в K8s. Часть 2»

### Задание 1

**Что нужно сделать**

Создать Deployment приложения, использующего локальный PV, созданный вручную.

1. Создать Deployment приложения, состоящего из контейнеров busybox и multitool.

    Deployment приложения: [deploy22.yaml](/2.2/deploy22.yaml)

2. Создать PV и PVC для подключения папки на локальной ноде, которая будет использована в поде.

    PV manifest: [pv.yaml](/2.2/pv.yaml)  
    PVC manifest: [pvc.yaml](/2.2/pvc.yaml)  

3. Продемонстрировать, что multitool может читать файл, в который busybox пишет каждые пять секунд в общей директории. 

    ![](/2.2/images/13-write.png)

4. Удалить Deployment и PVC. Продемонстрировать, что после этого произошло с PV. Пояснить, почему.  
    
    **После удаления PVC, PV перешел в статус "Released", т.к. стал отсутствовать потребитель в виде PVC.**  
    
    ![](/2.2/images/14-delete_pvc.png)

5. Продемонстрировать, что файл сохранился на локальном диске ноды. Удалить PV.  Продемонстрировать что произошло с файлом после удаления PV. Пояснить, почему.  

    **После удаления PV, файл сохранился на файловой системы ноды, т.к. PV выступает в качестве интерфейса к хранилищу и в общем виде нечего удалять не может.**  

    ![](/2.2/images/15-show_local_file.png)  

    ![](/2.2/images/15-delete_pv.png)  

6. Предоставить манифесты, а также скриншоты или вывод необходимых команд.

------

### Задание 2

**Что нужно сделать**

Создать Deployment приложения, которое может хранить файлы на NFS с динамическим созданием PV.

1. Включить и настроить NFS-сервер на MicroK8S.

    ![](/2.2/images/21-install_csi.png)  

2. Создать Deployment приложения состоящего из multitool, и подключить к нему PV, созданный автоматически на сервере NFS.

    ![](/2.2/images/22-create_pvc_deploy.png)  

3. Продемонстрировать возможность чтения и записи файла изнутри пода. 

    ![](/2.2/images/23-read_write_file.png)  

4. Предоставить манифесты, а также скриншоты или вывод необходимых команд.

    Deployment manifest: [deploy22-2.yaml](/2.2/deploy22-2.yaml)  
    PVC manifest: [pvc-auto.yaml](/2.2/pvc-auto.yaml)

------